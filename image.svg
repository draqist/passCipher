<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="356px" height="301px" viewBox="-0.5 -0.5 356 301" style="background-color: rgb(255, 255, 255);"><defs/><g><rect x="30" y="0" width="100" height="40" fill="#ffffff" stroke="#000000" pointer-events="all"/><path d="M 80 40 L 80 300" fill="none" stroke="#000000" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="all"/><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="12px"><text x="79.5" y="24.5">Device</text></g><rect x="75" y="70" width="10" height="190" fill="#e1d5e7" stroke="#9673a6" pointer-events="all"/><path d="M 19 70 L 66.88 70" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><ellipse cx="15" cy="70" rx="4" ry="4" fill="#000000" stroke="#000000" pointer-events="all"/><path d="M 73.88 70 L 66.88 73.5 L 66.88 66.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="11px"><rect fill="#ffffff" stroke="none" x="0" y="55" width="92" height="14" stroke-width="0"/><text x="44.5" y="64.5">Open WS channel</text></g><rect x="210" y="0" width="100" height="40" fill="#ffffff" stroke="#000000" pointer-events="all"/><path d="M 260 40 L 260 300" fill="none" stroke="#000000" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="all"/><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="12px"><text x="259.5" y="24.5">Client</text></g><rect x="255" y="80" width="10" height="160" fill="#d5e8d4" stroke="#82b366" pointer-events="all"/><path d="M 84.2 137.26 L 246.88 138.38" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 253.88 138.43 L 246.86 141.88 L 246.91 134.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="11px"><rect fill="#ffffff" stroke="none" x="117" y="122" width="106" height="14" stroke-width="0"/><text x="169.2" y="132.35">request for cipher-pin</text></g><path d="M 256 90 L 196 90 Q 186 90 176 90 L 94.12 90" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 87.12 90 L 94.12 86.5 L 94.12 93.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="11px"><rect fill="#ffffff" stroke="none" x="114" y="75" width="115" height="14" stroke-width="0"/><text x="170.5" y="84.5">Initiate  communication</text></g><path d="M 255 161 L 87.24 161" fill="none" stroke="#000000" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="stroke"/><path d="M 95.12 156.5 L 86.12 161 L 95.12 165.5" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="11px"><rect fill="#ffffff" stroke="none" x="130" y="145" width="82" height="14" stroke-width="0"/><text x="169.5" y="155.5">return cipher-pin</text></g><path d="M 84.2 109.52 L 254.36 109.99" fill="none" stroke="#000000" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="stroke"/><path d="M 246.47 114.47 L 255.48 110 L 246.49 105.47" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="11px"><rect fill="#ffffff" stroke="none" x="145" y="94" width="52" height="14" stroke-width="0"/><text x="169.7" y="104.26">return Ack</text></g><path d="M 30 178 L 310 178" fill="none" stroke="#314354" stroke-width="2" stroke-miterlimit="10" stroke-dasharray="2 6" pointer-events="stroke"/><rect x="265" y="160" width="90" height="20" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 170px; margin-left: 310px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: nowrap; "><font style="font-size: 9px">Handshake Stage</font></div></div></div></foreignObject><text x="310" y="174" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">Handshake Stage</text></switch></g><path d="M 255.8 200.48 L 93.12 200.98" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 86.12 201 L 93.11 197.48 L 93.13 204.48 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="11px"><rect fill="#ffffff" stroke="none" x="150" y="185" width="42" height="14" stroke-width="0"/><text x="169.8" y="195.24">request </text></g><path d="M 85.2 223.52 L 255.76 223.99" fill="none" stroke="#000000" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="stroke"/><path d="M 247.87 228.47 L 256.88 224 L 247.89 219.47" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="11px"><rect fill="#ffffff" stroke="none" x="144" y="208" width="56" height="14" stroke-width="0"/><text x="171.2" y="218.26">return data</text></g></g><switch><g requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"/><a transform="translate(0,-5)" xlink:href="https://www.diagrams.net/doc/faq/svg-export-text-problems" target="_blank"><text text-anchor="middle" font-size="10px" x="50%" y="100%">Viewer does not support full SVG 1.1</text></a></switch></svg>